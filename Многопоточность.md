# –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (concurrency)


## –£—Ä–æ–≤–Ω–∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –Ω–∞–¥ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å—é
–î–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ (concurrency), Apple –≤–≤–µ–ª–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–ø–µ—Ä–∏—Ä—É—é—Ç –æ–±–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ ‚Äî GCD –∏ Operation. 

### –û—á–µ—Ä–µ–¥—å (queue)
–û—á–µ—Ä–µ–¥–∏ (queues) ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏, –≤ –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ª—é–¥–∏, —á—Ç–æ–±—ã –∫—É–ø–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∏–ª–µ—Ç –≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä, –Ω–æ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –≤ –æ—á–µ—Ä–µ–¥—å –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∑–∞–º—ã–∫–∞–Ω–∏—è (closure ‚Äî –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –±–ª–æ–∫–∏ –∫–æ–¥–∞). –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö —Å–æ–≥–ª–∞—Å–Ω–æ –æ—á–µ—Ä–µ–¥–∏, ‚Äú–≤—ã–¥–µ—Ä–≥–∏–≤–∞—è‚Äù —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ –æ—á–µ—Ä–µ–¥–∏ –∏ –∑–∞–ø—É—Å–∫–∞—è –µ–≥–æ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —ç—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏ –ø–æ—Ç–æ–∫–µ. –û—á–µ—Ä–µ–¥–∏ (queues) —Å–ª–µ–¥—É—é—Ç FIFO –ø–∞—Ç—Ç–µ—Ä–Ω—É (First In, First Out), —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–æ—Ç, –∫—Ç–æ –ø–µ—Ä–≤—ã–º –±—ã–ª –ø–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –æ—á–µ—Ä–µ–¥—å, –±—É–¥–µ—Ç –ø–µ—Ä–≤—ã–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –£ –≤–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—á–µ—Ä–µ–¥–µ–π (queues) –∏ —Å–∏—Å—Ç–µ–º–∞ ‚Äú–≤—ã–¥–µ—Ä–≥–∏–≤–∞–µ—Ç‚Äù –∑–∞–º—ã–∫–∞–Ω–∏—è –ø–æ –æ–¥–Ω–æ–º—É –∏–∑ –∫–∞–∂–¥–æ–π –æ—á–µ—Ä–µ–¥–∏ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏—Ö –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å.

–ù–æ —ç—Ç–æ –ª–∏—à—å –æ–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (—Åoncurrency) —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ iOS. –ò–Ω—Ç—Ä–∏–≥–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Å–æ–±–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —ç—Ç–∏ –æ—á–µ—Ä–µ–¥–∏ –≤ —Å–º—ã—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –∏–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ) –∏ —Å –ø–æ–º–æ—â—å—é –∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π) —ç—Ç–∏ –∑–∞–¥–∞–Ω–∏—è –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å, —Ç–µ–º —Å–∞–º—ã–º –±–ª–æ–∫–∏—Ä—É—è –∏–ª–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—è —Ç–µ–∫—É—â—É—é –æ—á–µ—Ä–µ–¥—å.

–¢–∏–ø—ã –æ—á–µ—Ä–µ–¥–µ–π:
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ (serial)
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ (concurrent)

<img width="400" alt="–°–Ω–∏–º–æ–∫ —ç–∫—Ä–∞–Ω–∞ 2024-02-08 –≤ 07 30 31" src="https://github.com/DenDmitriev/iOS-Interview/assets/65191747/96a7818d-5d0a-4090-9a94-083b873f76d9">


–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏ (‚Äãserial queues)‚Äã ¬´–≤—ã—Ç—è–≥–∏–≤–∞—é—Ç¬ª –∑–∞–¥–∞–Ω–∏–µ (–∑–∞–º—ã–∫–∞–Ω–∏–µ), –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –æ—á–µ—Ä–µ–¥–∏, –∏ –¥–∞—é—Ç –µ–º—É —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏—Å—Ç—É–ø–∞—é—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É.

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏ (‚Äãconcurrent queues)‚Äã —Ç–æ–∂–µ –±–µ—Ä—É—Ç –≤ —Ä–∞–±–æ—Ç—É –∑–∞–¥–∞–Ω–∏–µ —Å–ø–µ—Ä–µ–¥–∏, –∑–∞–ø—É—Å–∫–∞—è –µ–≥–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ç–æ–∫–µ. –ï—Å–ª–∏ —É —Å–∏—Å—Ç–µ–º—ã –µ—Å—Ç—å –µ—â—ë —Ä–µ—Å—É—Ä—Å—ã, –æ–Ω–∞ —Å—Ä–∞–∑—É –ø—Ä–∏—Å—Ç—É–ø–∞–µ—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞–¥–∞–Ω–∏—é –∏–∑ –æ—á–µ—Ä–µ–¥–∏, –ø–æ—Å—ã–ª–∞—è –µ–≥–æ –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –ø–µ—Ä–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç. –¢–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç ¬´–≤—ã—Ç—è–Ω—É—Ç—å¬ª —Ü–µ–ª—ã–π —Ä—è–¥ –∑–∞–¥–∞—á.

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥—å (queue) —Å–æ–∑–¥–∞–Ω–∞, –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –Ω–µ–π –º–æ–∂–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –¥–≤—É—Ö —Ñ—É–Ω–∫—Ü–∏–π: 
- sync ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ —Ç–µ–∫—É—â–µ–π –æ—á–µ—Ä–µ–¥–∏
- async ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ —Ç–µ–∫—É—â–µ–π –æ—á–µ—Ä–µ–¥–∏.

–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è sync –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ç–µ–∫—É—â—É—é –æ—á–µ—Ä–µ–¥—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è, —Ç–µ–º —Å–∞–º—ã–º –±–ª–æ–∫–∏—Ä—É—è —Ç–µ–∫—É—â—É—é –æ—á–µ—Ä–µ–¥—å:

<img width="600" alt="49fda33d32be4a6ebb511bf0530a8854" src="https://github.com/DenDmitriev/iOS-Interview/assets/65191747/a9cc20f2-4851-4377-9a4e-4848bfe5e809">

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è async, –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ sync, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ç–µ–∫—É—â—É—é –æ—á–µ—Ä–µ–¥—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–æ–π –æ—á–µ—Ä–µ–¥–∏, –Ω–µ –æ–∂–∏–¥–∞—è –µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è async –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –Ω–∞ —Ç–µ–∫—É—â–µ–π –æ—á–µ—Ä–µ–¥–∏:

<img width="600" alt="c32c597b60d24ae69f5fffe4ca155d9c" src="https://github.com/DenDmitriev/iOS-Interview/assets/65191747/cf0360af-8ec8-4653-a291-ff0affca32c7">

–í —Å–ª—É—á–∞–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è (serial) –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ —Ç–µ–∫—É—â–µ–º—É –ø–æ—Ç–æ–∫—É

<img width="600" alt="cfc0fb700a034acbab2cc25fc6e14f17" src="https://github.com/DenDmitriev/iOS-Interview/assets/65191747/490a50f3-b1df-4652-ad9a-83c1855ecd77">

–ê –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è (concurrent) –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ —Ç–µ–∫—É—â–µ–º—É –ø–æ—Ç–æ–∫—É

<img width="600" alt="3919fb1ff81747dca78feabb45e3a9de" src="https://github.com/DenDmitriev/iOS-Interview/assets/65191747/ee9fcc7b-5857-451d-9a9d-33f51e0772b8">

### –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
–ó–∞–¥–∞—á–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ—Å—Ç–æ–∏—Ç —Ç–æ–ª—å–∫–æ –≤ –≤—ã–±–æ—Ä–µ –æ—á–µ—Ä–µ–¥–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è (–∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∑–∞–º—ã–∫–∞–Ω–∏—è), –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –≥–ª–∞–≤–Ω—É—é –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `DispatchQueue‚Äã.main.sync` –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `DispatchQueue‚Äã.main.async`, –¥–∞–ª—å—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ iOS.

–ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π —Å Main queue –Ω–∞ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫ –≤—Å–µ–≥–¥–∞ –ê–°–ò–ù–•–†–û–ù–ù–û. –ù–ò–ö–û–ì–î–ê –ù–ï –≤—ã–∑—ã–≤–∞–π—Ç–µ –º–µ—Ç–æ–¥ sync –Ω–∞ Main queue, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ deadlock –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!

#### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –æ—á–µ—Ä–µ–¥—å
–ü–æ–º–∏–º–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ—á–µ—Ä–µ–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å, —Å–∏—Å—Ç–µ–º–∞ iOS –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≥–æ—Ç–æ–≤—ã–µ (out-of-the-box) –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏ (queues). –ò—Ö 5:
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–µ—Ä–µ–¥—å Main queue**, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º (UI) 
```swift
let main = DispatchQueue.main
```
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ 4 —Ñ–æ–Ω–æ–≤—ã–µ concurrent –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–∏** —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```swift
// –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
let userInteractiveQueue = DispatchQueue.global(qos: .userInteractive)

let userInitiatedQueue = DispatchQueue.global(qos: .userInitiated)

let utilityQueue = DispatchQueue.global(qos: .utility)

// —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
let backgroundQueue = DispatchQueue.global(.background) 

// –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
// –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è qos –º–µ–∂–¥—É .userInitiated –∏ .utility.
let defaultQueue = DispatchQueue.global()
```

–ö–∞–∂–¥—É—é –∏–∑ —ç—Ç–∏—Ö –æ—á–µ—Ä–µ–¥–µ–π Apple –Ω–∞–≥—Ä–∞–¥–∏–ª–∞ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º ¬´–∫–∞—á–µ—Å—Ç–≤–æ–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è¬ª qos (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è Quality of Service), –∏ –º—ã –¥–æ–ª–∂–Ω—ã —Ä–µ—à–∏—Ç—å, –∫–∞–∫–∏–º –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–ª—è –Ω–∞—à–∏—Ö –∑–∞–¥–∞–Ω–∏–π.

> –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –≤—Å–µ —ç—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏ —è–≤–ª—è—é—Ç—Å—è –°–ò–°–¢–ï–ú–ù–´–ú–ò –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –æ—á–µ—Ä–µ–¥—è–º–∏ –∏ –Ω–∞—à–∏ –∑–∞–¥–∞–Ω–∏—è ‚Äî –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –≤ —ç—Ç–æ–π –æ—á–µ—Ä–µ–¥–∏! –¢–∞–∫–∂–µ –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏, –∫—Ä–æ–º–µ –æ–¥–Ω–æ–π, —è–≤–ª—è—é—Ç—Å—è concurrent (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏) –æ—á–µ—Ä–µ–¥—è–º–∏

## –ü—Ä–æ–±–ª–µ–º—ã –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –ø–æ–∑–≤–æ–ª—è–µ–º –∑–∞–¥–∞—á–∞–º (tasks) —Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø—Ä–æ–±–ª–µ–º—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ç–µ–º, —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∑–∞—Ö–æ—Ç—è—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ —Ä–µ—Å—É—Ä—Å–∞–º.
–û—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–∏:
- c–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏ (race condition)
- –∏–Ω–≤–µ—Ä—Å–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ (priority inversion)
- –≤–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (deadlock) ‚Äî —Å–∏—Ç—É–∞—Ü–∏—è –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤, –∑–∞–Ω—è—Ç—ã—Ö —Å–∞–º–∏–º–∏ —ç—Ç–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏ (race condition)
–æ—à–∏–±–∫–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–∏ –∫–æ–¥–∞

![multithreaded_testing](https://github.com/DenDmitriev/iOS-Interview/assets/65191747/cdabdb53-ab76-4f2a-853f-a0fdb7d4e324)

### –ò–Ω–≤–µ—Ä—Å–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ (priority inversion)

–î–æ–ø—É—Å—Ç–∏–º –≤ —Å–∏—Å—Ç–µ–º–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–µ –∑–∞–¥–∞—á–∏ —Å –Ω–∏–∑–∫–∏–º (–ê) –∏ –≤—ã—Å–æ–∫–∏–º (–ë) –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º. –í –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ T1 –∑–∞–¥–∞—á–∞ (–ê) –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –µ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å. –í –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ T2 –∑–∞–¥–∞—á–∞ (–ë) –≤—ã—Ç–µ—Å–Ω—è–µ—Ç –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É (–ê) –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≤–ª–∞–¥–µ—Ç—å —Ä–µ—Å—É—Ä—Å–æ–º –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ T3. –ù–æ —Ç–∞–∫ –∫–∞–∫ —Ä–µ—Å—É—Ä—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –∑–∞–¥–∞—á–∞ (–ë) –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ –æ–∂–∏–¥–∞–Ω–∏–µ, –∞ –∑–∞–¥–∞—á–∞ (–ê) –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –í –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –¢4 –∑–∞–¥–∞—á–∞ (–ê) –∑–∞–≤–µ—Ä—à–∞–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞ –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –µ–≥–æ. –¢–∞–∫ –∫–∞–∫ —Ä–µ—Å—É—Ä—Å –æ–∂–∏–¥–∞–µ—Ç –∑–∞–¥–∞—á–∞ (–ë), –æ–Ω–∞ —Ç—É—Ç –∂–µ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ (T4-T3) –Ω–∞–∑—ã–≤–∞—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –∏–Ω–≤–µ—Ä—Å–∏–µ–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤. –í —ç—Ç–æ–º –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî –∑–∞–¥–∞—á–∞ —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.

<img width="588" alt="2a40815749274c3897e581524cc2f539" src="https://github.com/DenDmitriev/iOS-Interview/assets/65191747/5e496e03-b225-4fde-b64b-533ece56ed6d">

### –í–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (deadlock)
–í–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Äî —ç—Ç–æ –∞–≤–∞—Ä–∏–π–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –ø—Ä–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Ä–µ—Å—É—Ä—Å–æ–≤. 
–ù–∞–ø—Ä–∏–º–µ—Ä –µ—Å–ª–∏ –º—ã –∑–∞–ø—É—Å—Ç–∏–º —ç—Ç–æ—Ç –∫–æ–¥ —Ç–æ –ø–æ–ª—É—á–∏–º –≤ –∫–æ–Ω—Å–æ–ª–∏ —Ç–æ–ª—å–∫–æ –∞–Ω–≥–µ–ª–∞. –í—Å—è–∫–∞—è **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–µ—Ä–µ–¥—å** –∂–¥—ë—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏, –ø–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –Ω–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â—É—é. –ö–æ–≥–¥–∞ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –°–ò–ù–•–†–û–ù–ù–û –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å —Ç–µ–∫—É—â—É—é –∑–∞–¥–∞—á—É, –º—ã –ø–æ–ª—É—á–∞–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –∫–æ–≥–¥–∞ –º—ã –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–¥ —Å —á–µ—Ä—Ç–∏–∫–æ–º, —Ç–æ –º—ã —ç—Ç–æ –¥–µ–ª–∞–µ–º –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–∫—É—â–µ–π, —É–∂–µ –≤—ã–ø–æ–ª–Ω—è—é—â–µ–π—Å—è –≤ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á–∏ –ò –ø—ã—Ç–∞–µ–º—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –¥–æ–ª–∂–Ω—ã –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏. –ù–æ –∫–∞–∫ –º—ã –º–æ–∂–µ–º –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É –≤ –∫–æ—Ç–æ—Ä–æ–π –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è, –µ—Å–ª–∏ –º—ã —Å–∞–º–∏ –µ—ë –∏ —Ç–æ—Ä–º–æ–∑–∏–º? –≠—Ç–æ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–∑–∞–∏–º–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π. –ê–Ω–≥–µ–ª –∂–¥—ë—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä—Ç–∏–∫–∞, –∞ —á–µ—Ä—Ç–∏–∫ –∂–¥—ë—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–æ –±–ª–æ–∫–∞ –∑–∞–º—ã–∫–∞–Ω–∏—è –∞–Ω–≥–µ–ª–∞ —Å —Ñ–ª–∞–≥–æ–º —Ñ–∏–Ω–∏—à–∞.
```swift
let serialQueue = DispatchQueue(label: "my.queue")
serialQueue.async {
    print("üòá") 
    serialQueue.sync { // deadlock
        print("üòà")
    }
    print("üèÅ")
}
// üòá
// deadlock 
```
–ß—Ç–æ–± –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–≥–æ, –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –æ—á–µ—Ä–µ–¥–∏ –∫–∞–∫ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ã–π
```swift
let concurrentQueue = DispatchQueue(label: "my.queue", attributes: .concurrent)
concurrentQueue.async {
    print("üòá")
    concurrentQueue.sync {
        print("üòà")
    }
    print("üèÅ")
}
// üòá
// üòà
// üèÅ
```
–ß—Ç–æ –Ω–∞—Å—á–µ—Ç –≥–ª–∞–≤–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π**? –ó–∞–ø—É—Å–∫–∞—è –≤–ª–æ–∂–µ–Ω—ã–π –∫–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –º—ã –ø–æ–ª—É—á–∞–µ–º —Ç–æ–∂–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –Ω–æ –Ω–µ—è–≤–Ω–æ:
```swift
print("üòá")
DispatchQueue.main.sync {  // error: Execution was interrupted, reason: EXC_BREAKPOINT (code=1, subcode=0x1837e8028). –ü—Ä–æ—Ü–µ—Å—Å –æ—Å—Ç–∞–ª—Å—è –≤ —Ç–æ–º –º–µ—Å—Ç–µ, –≥–¥–µ –æ–Ω –±—ã–ª –ø—Ä–µ—Ä–≤–∞–Ω.
    print("üòà")
}
print("üèÅ")
// üòá
// deadlock –Ω–µ—è–≤–Ω–æ
```
–í–∑–∞–∏–º–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–æ–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å, –∏–ª–∏ –µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª —É–≤–µ–ª–∏—á–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞.

> –ù–ò–ö–û–ì–î–ê –ù–ï –≤—ã–∑—ã–≤–∞–π—Ç–µ –º–µ—Ç–æ–¥ sync –Ω–∞ main queue, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –≤–∑–∞–∏–º–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ (deadlock) –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!
