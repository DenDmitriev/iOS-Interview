# Отличия TCP и UDP протоколов
Это сетевые протоколы транспортного уровня.

> Сетевые протоколы — это правила взаимодействия устройств в сети, благодаря которым различные девайсы могут работать друг с другом, несмотря на конструктивные различия. На транспортном уровне происходит прием данных с сетевого уровня и передача их на сеансовый уровень.


## TCP — протокол транспортного уровня
TCP или Transmission Control Protocol - это сетевой протокол, который используется для транспортировки сообщений между устройствами в сети.

В сети файлы не передаются целиком, а дробятся и передаются в виде относительно небольших сообщений. Далее они передаются другому устройству — получателю, где повторно собираются в файл.

Например, человек хочет скачать картинку. 
1. Сервер обрабатывает запрос и высылает в ответ требуемое изображение.
2. Серверу, в свою очередь, необходим путь или канал, по которому он будет передавать информацию. Поэтому сервер обращается к сетевому сокету (коммутатору) для установки требуемого соединения и отправки картинки.
3. Сервер дробит данные, инкапсулирует их в блоки, которые передаются на уровень TCP получателя при помощи IP-протокола.
4. Далее получатель подтверждает факт передачи.

> Со́кет (англ. socket — разъём) — название программного интерфейса для обеспечения обмена данными между процессами. Процессы при таком обмене могут исполняться как на одной ЭВМ, так и на различных ЭВМ, связанных между собой только сетью. Сокет — абстрактный объект, представляющий конечную точку соединения. Клиентские сокеты грубо можно сравнить с конечными аппаратами телефонной сети, а серверные — с коммутаторами. 

У протокола TCP есть несколько особенностей:
- **Система нумерации сегментов**. TCP отслеживает передаваемые и принимаемые сегменты, присваивая номера каждому из них. Байтам данных, которые должны быть переданы, присваивается определенный номер байта, в то время как сегментам присваиваются порядковые номера.
- **Управление потоком**. Функция ограничивает скорость, с которой отправитель передает данные. Это делается для обеспечения надежности доставки, в том числе чтобы компьютер не генерировал пакетов больше, чем может принять другое устройство. Если говорить простым языком, то получатель постоянно сообщает отправителю о том, какой объем данных может быть получен.
- **Контроль ошибок**. Функция реализуется для повышения надежности путем проверки байтов на целостность.
- **Контроль перегрузки сети**. Протокол TCP учитывает уровень перегрузки в сети, определяемый объемом данных, отправленных узлом.

### Примеры применения сетевого протокола TCP
Протокол TCP гарантирует доставку, а также обеспечивает целостность данных, передаваемых в сети. Поэтому он применяется для передачи данных, которые чувствительны к нарушению целостности, — например, текстов, файлов и т.п. Вот несколько протоколов, которые работают по TCP: 
- SSH, FTP, Telnet: в данных протоколах TCP используется для обмена файлами.
- SMTP, POP, IMAP: протоколы, где TCP отвечает за передачу сообщений электронной почты.
- HTTP/HTTPS: протоколы, где TCP отвечает за загрузку страниц из интернета.

Эти примеры работают на уровне приложений стека TCP/IP и передают данные вниз к TCP, на транспортный уровень.

### Строение протокола TCP
![схема2-2](https://github.com/DenDmitriev/iOS-Interview/assets/65191747/47671384-28b7-44ce-8396-dc92a88e24b0)
Структура заголовка
<table>
    <tbody><tr align="center">
        <th colspan="1" width="3%"><a href="/wiki/%D0%91%D0%B8%D1%82" title="Бит">Бит</a>
        </th>
        <th colspan="4" width="12%">0&nbsp;— 3
        </th>
        <th colspan="6" width="18%">4&nbsp;— 6
        </th>
        <th colspan="6" width="18%">7&nbsp;— 15
        </th>
        <th colspan="16" width="48%">16&nbsp;— 31
        </th></tr>
        <tr align="center">
            <th colspan="1">0
            </th>
            <td colspan="16">Порт источника, <b>Source Port</b>&nbsp;
            </td>
            <td colspan="16">Порт назначения, <b>Destination Port</b>
            </td></tr>
        <tr align="center">
            <th colspan="1">32
            </th>
            <td colspan="32">Порядковый номер, <b>Sequence Number (SN)</b>
            </td></tr>
        <tr align="center">
            <th colspan="1">64
            </th>
            <td colspan="32">Номер подтверждения, <b>Acknowledgment Number (ACK SN)</b>
            </td></tr>
        <tr align="center">
            <th colspan="1">96
            </th>
            <td colspan="4">Длина заголовка, (<b>Data offset</b>)
            </td>
            <td colspan="6">Зарезервировано
            </td>
            <td colspan="6">Флаги
            </td>
            <td colspan="16">Размер Окна, <b>Window size</b>
            </td></tr>
        <tr align="center">
            <th colspan="1">128
            </th>
            <td colspan="16">Контрольная сумма, <b>Checksum</b>
            </td>
            <td colspan="16">Указатель важности, <b>Urgent Point</b>
            </td></tr>
        <tr align="center">
            <th colspan="1">160
            </th>
            <td colspan="32" bgcolor="#FFDDDD">Опции (необязательное, но используется практически всегда)
            </td></tr>
        <tr align="center">
            <th colspan="1">160/192+
            </th>
            <td colspan="32">Данные
            </td></tr></tbody>
</table>

В каждый пакет данных TCP добавляет заголовок общим объемом в 20 байт (или октетов), в котором содержатся 10 обязательных полей:
- **Порт источника** — порт устройства-отправителя.
- **Порт назначения** — порт принимающего устройства.
- **Порядковый номер**. Устройство, инициирующее TCP-соединение, должно выбрать случайный начальный порядковый номер, который затем увеличивается в соответствии с количеством переданных байтов.
- **Номер подтверждения**. Принимающее устройство увеличивает этот номер с нуля в соответствии с количеством полученных байтов.
- **Сдвиг данных TCP**. Данный параметр определяет размер заголовка, чтобы система могла понять, где начинаются данные.
- **Зарезервированные данные** — зарезервированное поле, значение которого всегда равно нулю.
- **Флаги управления**. TCP использует девять флагов для управления потоком данных в определенных ситуациях — например, при инициировании сброса сессии.
- **Размер окна** — самая важная часть заголовка TCP. Это поле используется получателем для указания отправителю объема данных, которые он может принять.
- **Контрольная сумма**. Отправитель генерирует контрольную сумму и передает ее в заголовке каждого пакета. Принимающее устройство может использовать контрольную сумму для проверки ошибок в полученном файле.
- **Срочный указатель** — это предлагаемая протоколом возможность помечать некоторые байты данных тегом «Срочно» для их пересылки и обработки вне очереди.
- **Поле опции**. Может использоваться для расширения протокола или его тестирования.
