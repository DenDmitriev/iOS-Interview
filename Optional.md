# Опциональные типы

Опциональные типы используются когда значение может отсутвовать. 
Это означает что возможны два варианта:
 - Либо значение существует и его можно извлечь из опционала
 - Либо его нет вообще

## Как это работает?
Опционал в Swift представляет из себя особый объект-контейнер так называемое значения в контексте или [Функтор](https://teletype.in/@hw_code/cDFOQ-XK2), который может содержать в себе либо nil, либо объект конкретного типа, который указывается при объявлении этого контейнера. Эти два состояния обозначаются терминами None и Some соответственно которые приводятся в Enum объекте. Если при создании опциональной переменной присваемое значение не указывать, то nil присваивается по умолчанию.

## Объявление опционалов
Если объявить опциональную переменную без присвоения значения по умолчанию, то переменная автоматически установится в nil для вас
```swift
var surveyAnswer: String?
// surveyAnswer автоматически установится в nil

let possibleNumber = "123" // Int
let convertedNumber = Int(possibleNumber) // Int?
```

## Извлечение опционала:
- [Принудительное извлчение](#принудительное-извлчение)
- [Привязка опционалов (optional binding)](#привязка-опционалов-optional-binding)
- [Слияние (nil coalescing)](#слияние-nil-coalescing)
- [Неявно извлеченные опционалы](#неявно-извлеченные-опционалы)

Наиболее безопасными и поэтому рекомендуемыми механизмами работы с опционалами являются optional binding и nil coalescing.

### Принудительное извлчение

Если вы уверены, что опционал содержит значение, вы можете получить доступ к его значению, добавив восклицательный знак (!) в конце имени опционала.
Восклицательный знак фактически говорит: «Я знаю точно, что этот опционал содержит значение, пожалуйста, используй его».

```swift
if convertedNumber != nil {
    print("convertedNumber has an integer value of \(convertedNumber!).")
}
// Выведет "convertedNumber has an integer value of 123."
```

### Привязка опционалов (optional binding)
Можно использовать Привязку опционалов, чтобы выяснить содержит ли опционал значение, и если да, то сделать это значение доступным в качестве временной константы или переменной.
Привязка опционалов может использоваться с инструкциями if и while.
```swift
if let actualNumber = Int(possibleNumber) {
    print("\(possibleNumber) has an integer value of \(actualNumber)")
} else {
    print("\(possibleNumber) could not be converted to an integer")
}
// Выведет "123" has an integer value of 123
```
Если преобразование прошло успешно, константа actualNumber становится доступной для использования внутри первого ветвления инструкции if.
Константы и переменные, созданные через опциональную привязку в инструкции if, будут доступны только в теле инструкции if. В противоположность этому, константы и переменные, созданные через инструкцию guard, доступны в строках кода
```swift
guard let possibleNumber else { return }
print("\(possibleNumber) has an integer value of \(actualNumber)")
// Выведет "123" has an integer value of 123
```

### Слияние (nil coalescing)
Вариант распаковки опционала является механизм nil coalescing (соединения с nil) с использованием оператора ??
```swift
let possibleNumber = "123" // Int
let convertedNumber = Int(possibleNumber) ?? 0
```
В случае, когда опционал не равен nil, его значение записывается в переменную, в противном случае в переменную записывается значение по умолчанию, расположенное справа от оператора ??.

### Неявно извлеченные опционалы
Константам или переменным разрешено не иметь «никакого значения». Опционалы можно проверить с помощью инструкции if/guard, чтобы увидеть существует ли значение, и при условии, если оно существует, можно извлечь его с помощью привязки опционалов для доступа к опциональному значению.

Эти виды опционалов называются неявно извлеченные опционалы. Их можно писать, используя восклицательный знак (String!), вместо вопросительного знака (String?), после типа, который вы хотите сделать опциональным.

Вместо того, чтобы ставить восклицательный знак (!) после опционала, когда вы его используете, поместите восклицательный знак (!) после опционала, когда вы его объявляете.
```swift
let possibleString: String? = "An optional string."
let forcedString: String = possibleString! // необходим восклицательный знак

let assumedString: String! = "An implicitly unwrapped optional string."
let implicitString: String = assumedString // восклицательный знак не нужен
```
